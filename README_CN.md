中文 | [English](README.md)

# 3dmigoto Mods 合并脚本 (命名空间版)

一个 Python 脚本，用于将多个 3dmigoto mod 合并成一个可切换的 mod 包。这使您可以在游戏中使用热键循环切换不同的 mod。

该脚本基于“命名空间”技术，该技术可以隔离 mod 文件以防止冲突并实现动态加载。

## 功能

-   将多个 3dmigoto mod 合并为一个。
-   允许使用可配置的热键在游戏中切换 mod。
-   可选的“后退”键可返回上一个 mod。
-   自动检测并处理 `.ini` 文件。
-   可以将 mod 切换限制为仅影响屏幕上显示的角色。
-   交互式提示输入 mod 合并顺序、角色名称和热键。
-   可以禁用原始 mod 文件，以防止它们与合并后的 mod 一起加载。
-   可以重新启用之前禁用的 mod 文件。

## 先决条件

-   [Python 3](https://www.python.org/downloads/)

## 如何使用

1.  **准备您的 mod：**
    -   为您的 mod 创建一个主文件夹。
    -   将要合并的每个 mod 放入主文件夹内的独立子文件夹中。
    -   将 `3dm_merge_mods_cn.py` 脚本放入主文件夹中。您的目录结构应如下所示：

    ```
    /我的Mods/
    |-- 3dm_merge_mods_cn.py
    |-- Mod1/
    |   |-- Mod1.ini
    |   |-- ... (其他 mod 文件)
    |-- Mod2/
    |   |-- Mod2.ini
    |   |-- ... (其他 mod 文件)
    |-- Mod3/
        |-- Mod3.ini
        |-- ... (其他 mod 文件)
    ```

2.  **运行脚本：**
    -   在您的主文件夹（例如 `我的Mods`）中打开命令提示符或终端。
    -   使用 `python 3dm_merge_mods_cn.py` 运行脚本。

3.  **按照提示操作：**
    -   **Mod 顺序：** 脚本将列出所有找到的 `.ini` 文件。输入您希望的合并顺序，以空格分隔数字（例如 `1 0 2`）。按 Enter 键使用默认顺序。
    -   **角色名称：** 脚本将根据第一个 mod 建议一个角色名称。您可以按 Enter 接受它，或提供一个自定义名称。此名称用于生成的文件。
    -   **热键：** 系统将提示您输入一个用于循环切换 mod 的键（例如 `K` 或虚拟键码如 `VK_RIGHT`）以及一个可选的后退键。

4.  **完成！**
    -   脚本将创建一个 `merged.ini` 文件（或您指定的名称）和一个以您的角色命名的文件夹（例如 `角色名.namespace/`）。
    -   原始 mod 的 `.ini` 文件将被重命名为 `DISABLED...` 以禁用它们。
    -   将新生成的 `merged.ini` 和 `角色名.namespace` 文件夹复制到 3dmigoto 安装位置的游戏 `Mods` 目录中。

## 命令行参数

您可以使用这些参数自定义脚本的行为：

| 参数 | 缩写 | 描述 | 默认值 |
|---|---|---|---|
| `--root <路径>` | `-r` | 您的 mod 文件夹所在的目录。 | `.` (当前目录) |
| `--name <文件名>` | `-n` | 最终合并的 `.ini` 文件的名称。 | `merged.ini` |
| `--key <键>` | `-k` | 用于循环切换 mod 的热键。 | 提示用户输入 |
| `--back_key <键>` | `-b` | 用于向后循环的热键。 | 提示用户输入 |
| `--store` | `-s` | 合并后保持原始 `.ini` 文件为启用状态。 | 禁用 |
| `--active` | `-a` | 仅在屏幕上当前角色处于活动状态时才切换 mod。 | 启用 |
| `--enable` | `-e` | 一个实用功能，用于重新启用根文件夹中所有被禁用的 `.ini` 文件。 | 禁用 |

**示例：**```bash
python 3dm_merge_mods_cn.py -n "我的超酷整合包.ini" -k "VK_F5"
```

## 鸣谢

-   **Qian23333:** 此脚本的作者。
-   **SilentNightSound#7430:** 原始脚本框架。
-   **Takoyaki#0697:** 概念验证和原理演示。
-   **HazrateGolabi#1364:** 实现将切换限制于屏幕上角色的代码。